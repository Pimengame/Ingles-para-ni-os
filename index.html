<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escuela de InglÃ©s</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <button id="btn-musica" class="btn-musica-flotante" title="Activar/Desactivar MÃºsica">ğŸ”‡</button>

    <div id="selector-personaje" class="modal-personaje">
        <h1 class="titulo-personaje">Â¿QuiÃ©n eres?</h1>
        <div class="contenedor-opciones">
            <div class="opcion-avatar" onclick="elegirPersonaje('nino')">
                <span class="avatar-img">ğŸ‘¦</span>
                <span class="avatar-texto">NiÃ±o</span>
            </div>
            <div class="opcion-avatar" onclick="elegirPersonaje('nina')">
                <span class="avatar-img">ğŸ‘§</span>
                <span class="avatar-texto">NiÃ±a</span>
            </div>
        </div>
    </div>

    <div style="margin-top: 40px;">
        <span id="icono-bienvenida" style="font-size: 80px; display:block; animation: flotar 3s infinite;">ğŸ°</span>
        <h1 id="titulo-bienvenida">Escuela de InglÃ©s</h1>
        <p style="font-size: 1.2rem; color: #555;">Â¡Elige una aventura para comenzar!</p>
        <button onclick="borrarMemoria()" style="background:none; border:none; color:#aaa; cursor:pointer; margin-top:10px; font-family:'Nunito'; text-decoration:underline;">(Cambiar personaje)</button>
    </div>

    <div style="margin: 20px auto; max-width: 800px;">
        <a href="album.html" class="tarjeta-menu" style="background: #fff9c4; border-color: #ffd700; display: flex;">
            <div style="font-size: 60px;">ğŸ†</div>
            <span class="titulo-menu" style="color: #fbc02d;">Mi Ãlbum de Premios</span>
            <p style="margin: 5px 0 0 0; color: #888; font-size: 0.9rem;">Â¡Colecciona todas las estampitas!</p>
        </a>
    </div>

    <div style="margin: 20px auto; max-width: 800px;">
        <a href="memoria.html" class="tarjeta-menu" style="background: #e1bee7; border-color: #ba68c8; display: flex;">
            <div style="font-size: 60px;">ğŸ§ </div>
            <span class="titulo-menu" style="color: #8e24aa;">Juego de Memoria</span>
            <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9rem;">Encuentra las parejas: Imagen y Palabra</p>
        </a>
    </div>

    <div style="margin: 20px auto; max-width: 800px;">
        <a href="piano.html" class="tarjeta-menu" style="background: #37474f; border-color: #263238; display: flex;">
            <div style="font-size: 60px;">ğŸ¹</div>
            <span class="titulo-menu" style="color: #ffffff;">Piano MÃ¡gico</span>
            <p style="margin: 5px 0 0 0; color: #ccc; font-size: 0.9rem;">Â¡Crea tu propia mÃºsica!</p>
        </a>
    </div>

    <div class="menu-grid">
        <a href="temas/saludos.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ‘‹</div>
            <span class="titulo-menu">Saludos</span>
        </a>
        <a href="temas/conversacion.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ’¬</div>
            <span class="titulo-menu">Frases</span>
        </a>
        <a href="temas/animales.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ¦</div>
            <span class="titulo-menu">Animales</span>
        </a>
        <a href="temas/numeros.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ”¢</div>
            <span class="titulo-menu">NÃºmeros</span>
        </a>
        <a href="temas/cuerpo.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ‘ƒ</div>
            <span class="titulo-menu">El Cuerpo</span>
        </a>
        <a href="temas/colores.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ¨</div>
            <span class="titulo-menu">Colores</span>
        </a>
        <a href="temas/casa.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸ </div>
            <span class="titulo-menu">La Casa</span>
        </a>
        <a href="temas/transportes.html" class="tarjeta-menu">
            <div style="font-size: 60px;">ğŸš—</div>
            <span class="titulo-menu">Transportes</span>
        </a>
    </div>

    <script>
        // --- 1. CONFIGURACIÃ“N DE AUDIO ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx = new AudioContext();
        
        // MÃºsica de fondo (Requiere archivo 'fondo.mp3' en la carpeta)
        const musicaFondo = new Audio('fondo.mp3');
        musicaFondo.loop = true; 
        musicaFondo.volume = 0.2; // Volumen suave
        let musicaActiva = false;

        // --- 2. SINTETIZADOR DE EFECTOS (Sin archivos extra) ---
        function playSound(tipo) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (tipo === 'hover') {
                // Burbuja suave
                osc.type = 'sine';
                osc.frequency.setValueAtTime(400, now);
                osc.frequency.linearRampToValueAtTime(600, now + 0.1);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);

            } else if (tipo === 'click') {
                // Pop agradable
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.exponentialRampToValueAtTime(50, now + 0.15);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.15);
                osc.start(now); osc.stop(now + 0.15);
            }
        }

        // --- 3. LÃ“GICA DE MÃšSICA ---
        const btnMusica = document.getElementById('btn-musica');

        function toggleMusica() {
            if (musicaActiva) {
                musicaFondo.pause();
                musicaActiva = false;
                btnMusica.innerHTML = "ğŸ”‡";
                btnMusica.classList.remove('sonando');
                btnMusica.style.borderColor = "#ffca28";
            } else {
                musicaFondo.play().then(() => {
                    musicaActiva = true;
                    btnMusica.innerHTML = "ğŸµ";
                    btnMusica.classList.add('sonando');
                    btnMusica.style.borderColor = "#00e676";
                }).catch(e => console.log("Click necesario"));
            }
        }

        btnMusica.addEventListener('click', () => {
            playSound('click');
            toggleMusica();
        });

        // Intentar iniciar mÃºsica al primer clic en cualquier lado
        document.body.addEventListener('click', function iniciarAudioForzado() {
            if (!musicaActiva) toggleMusica();
            document.body.removeEventListener('click', iniciarAudioForzado);
        }, { once: true });

        // --- 4. LÃ“GICA DE PERSONAJE (Tu cÃ³digo original + Sonidos) ---
        const usuarioGuardado = localStorage.getItem('miPersonaje');
        const modal = document.getElementById('selector-personaje');

        if (usuarioGuardado) {
            modal.style.display = 'none';
            aplicarPersonalizacion(usuarioGuardado);
        } else {
            modal.style.display = 'flex';
        }

        function elegirPersonaje(tipo) {
            playSound('click'); // Â¡Sonido al elegir!
            localStorage.setItem('miPersonaje', tipo);
            modal.classList.add('ocultar-modal');
            setTimeout(() => {
                modal.style.display = 'none';
                aplicarPersonalizacion(tipo);
            }, 500);
        }

        function aplicarPersonalizacion(tipo) {
            const titulo = document.getElementById('titulo-bienvenida');
            const icono = document.getElementById('icono-bienvenida');
            const root = document.documentElement.style;

            if (tipo === 'nino') {
                titulo.innerText = "Â¡Bienvenido, CampeÃ³n!";
                icono.innerText = "ğŸ‘¦";
                root.setProperty('--bg-color', '#e0f7fa');
                root.setProperty('--dots-color', '#b2ebf2');
                root.setProperty('--primary', '#00bcd4');
            } else {
                titulo.innerText = "Â¡Bienvenida, Campeona!";
                icono.innerText = "ğŸ‘§";
                root.setProperty('--bg-color', '#fce4ec');
                root.setProperty('--dots-color', '#f8bbd0');
                root.setProperty('--primary', '#ec407a');
                root.setProperty('--accent', '#ab47bc');
            }
        }

        function borrarMemoria() {
            if(confirm('Â¿Quieres volver a elegir personaje?')) {
                playSound('click');
                localStorage.removeItem('miPersonaje');
                location.reload();
            }
        }

        // --- 5. APLICAR SONIDOS A TODAS LAS TARJETAS ---
        document.addEventListener('DOMContentLoaded', () => {
            const tarjetas = document.querySelectorAll('.tarjeta-menu, .opcion-avatar, button');
            
            tarjetas.forEach(tarjeta => {
                tarjeta.addEventListener('mouseenter', () => playSound('hover'));
                
                // Si es un enlace, retrasamos un poco la navegaciÃ³n para oÃ­r el sonido
                if(tarjeta.tagName === 'A') {
                    tarjeta.addEventListener('click', (e) => {
                        e.preventDefault();
                        playSound('click');
                        const href = tarjeta.getAttribute('href');
                        setTimeout(() => window.location.href = href, 200);
                    });
                }
            });
        });
    </script>

</body>
</html>
